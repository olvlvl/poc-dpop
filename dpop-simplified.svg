<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="533px" preserveAspectRatio="none" style="width:700px;height:533px;background:#FFFFFF;" version="1.1" viewBox="0 0 700 533" width="700px" zoomAndPan="magnify"><defs/><g><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="371.0371" width="8" x="23.7524" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="27" x2="27" y1="81.4883" y2="452.5254"/></g><g><title>Authorization Server</title><rect fill="#000000" fill-opacity="0.00000" height="371.0371" width="8" x="237.3188" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="240.6948" x2="240.6948" y1="81.4883" y2="452.5254"/></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="371.0371" width="8" x="384.9673" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="388.9429" x2="388.9429" y1="81.4883" y2="452.5254"/></g><g class="participant participant-head" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5049" x="5" y="78.5352">Client</text><ellipse cx="27.7524" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M27.7524,21.5 L27.7524,48.5 M14.7524,29.5 L40.7524,29.5 M27.7524,48.5 L14.7524,63.5 M27.7524,48.5 L40.7524,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5049" x="5" y="465.0605">Client</text><ellipse cx="27.7524" cy="476.5137" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M27.7524,484.5137 L27.7524,511.5137 M14.7524,492.5137 L40.7524,492.5137 M27.7524,511.5137 L14.7524,526.5137 M27.7524,511.5137 L40.7524,526.5137" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="AS"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153.248" x="164.6948" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139.248" x="171.6948" y="70.5352">Authorization Server</text></g><g class="participant participant-tail" data-participant="AS"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153.248" x="164.6948" y="451.5254"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139.248" x="171.6948" y="472.0605">Authorization Server</text></g><g class="participant participant-head" data-participant="RS"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.0488" x="327.9429" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.0488" x="334.9429" y="70.5352">Resource Server</text></g><g class="participant participant-tail" data-participant="RS"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.0488" x="327.9429" y="451.5254"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.0488" x="334.9429" y="472.0605">Resource Server</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="693.8027" x="0" y="112.1436"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="693.8027" y1="112.1436" y2="112.1436"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="693.8027" y1="115.1436" y2="115.1436"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="122.4878" x="285.6575" y="101.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.2031" x="291.6575" y="118.0566">Token Issuance</text><g class="message" data-participant-1="Client" data-participant-2="AS"><polygon fill="#181818" points="229.3188,167.4199,239.3188,171.4199,229.3188,175.4199,233.3188,171.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="27.7524" x2="235.3188" y1="171.4199" y2="171.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.21" x="34.7524" y="151.3672">(A) Token Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.9175" x="34.7524" y="166.6777">(DPoP Proof)</text></g><path d="M246,184.4199 L246,224.4199 L512,224.4199 L512,194.4199 L502,184.4199 L246,184.4199" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M502,184.4199 L502,194.4199 L512,194.4199 L502,184.4199" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.0454" x="252" y="201.9883">The AS verifies the DPoP Proof</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.686" x="252" y="217.2988">and binds the token to the client's key.</text><g class="message" data-participant-1="AS" data-participant-2="Client"><polygon fill="#181818" points="38.7524,262.6621,28.7524,266.6621,38.7524,270.6621,34.7524,266.6621" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="32.7524" x2="240.3188" y1="266.6621" y2="266.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.5664" x="44.7524" y="246.6094">(B) DPoP-Bound Access Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.2183" x="44.7524" y="261.9199">(token_type=DPoP)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="693.8027" x="0" y="295.3174"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="693.8027" y1="295.3174" y2="295.3174"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="693.8027" y1="298.3174" y2="298.3174"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="129.521" x="282.1409" y="284.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2363" x="288.1409" y="301.2305">Resource Access</text><g class="message" data-participant-1="Client" data-participant-2="RS"><polygon fill="#181818" points="376.9673,350.5938,386.9673,354.5938,376.9673,358.5938,380.9673,354.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="27.7524" x2="382.9673" y1="354.5938" y2="354.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.0835" x="34.7524" y="334.541">(C) DPoP-Bound Access Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.9175" x="34.7524" y="349.8516">(DPoP Proof)</text></g><path d="M393,367.5938 L393,407.5938 L688,407.5938 L688,377.5938 L678,367.5938 L393,367.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M678,367.5938 L678,377.5938 L688,377.5938 L678,367.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.9336" x="399" y="385.1621">The RS verifies the token signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.8027" x="399" y="400.4727">and the DPoP Proof against the token's key.</text><g class="message" data-participant-1="RS" data-participant-2="Client"><polygon fill="#181818" points="38.7524,430.5254,28.7524,434.5254,38.7524,438.5254,34.7524,434.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="32.7524" x2="387.9673" y1="434.5254" y2="434.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.3237" x="44.7524" y="429.7832">(D) Protected Resource</text></g><!--SRC=[VP31Ri8m38RlUGgBo-Y1FS2aJYfmuOPIZaXJ5bngmPmkTYUnfr-QLZ2GjakYg9z__r_bHDovw3v0z7B6T4RoQepp6YAipeIi9W5AdZh72hEgrpP4-dPAWQ76-8Ln1awWgkz1YnBwwF4tOsjZoX9suOGC6v7USGBAqfXn5InUKyuBpAjYWYn-zYYwv_bw6xQmZI4qXU6W296EhK9eyiIknNH3MaGDeO2czsrYpuuFy4vy6BzepjQG7pwlVX8uuUNPc9IoI3N6GgdAiiX1YsNeKqRbFOgCvLAf7FIcbmxB0IgotjLyWk_zxE2t-Y_qRrCxcTe7qz57wCXE-uYZxlql07TqnA8t_cfi7upNnJ2Yw1KFLndp0m00]--></g></svg>